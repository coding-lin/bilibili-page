import{r as o,n as h,o as C,q as T,v as I,w as b,x as L,y as P,j as t,z as R,d as p,F as v,f as M}from"./index.b82d8aea.js";import{D as x}from"./index.cb20383e.js";import{u as N}from"./index.bf64f6a9.js";function k(r){var e=this,n=o.exports.useRef(!1);return o.exports.useCallback(function(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];return h(e,void 0,void 0,function(){var u,f;return C(this,function(c){switch(c.label){case 0:if(n.current)return[2];n.current=!0,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,r.apply(void 0,T([],I(s),!1))];case 2:return u=c.sent(),n.current=!1,[2,u];case 3:throw f=c.sent(),n.current=!1,f;case 4:return[2]}})})},[r])}function B(r){return r===window}const y="adm-infinite-scroll",j={threshold:250,children:(r,e,n)=>t(D,{hasMore:r,failed:e,retry:n})},z=r=>{const e=b(j,r),[n,s]=o.exports.useState(!1),l=k(a=>h(void 0,void 0,void 0,function*(){try{yield e.loadMore(a)}catch(i){throw s(!0),i}})),u=o.exports.useRef(null),[f,c]=o.exports.useState({}),m=o.exports.useRef(f),[d,w]=o.exports.useState(),{run:g}=N(()=>h(void 0,void 0,void 0,function*(){if(m.current!==f||!e.hasMore)return;const a=u.current;if(!a||!a.offsetParent)return;const i=L(a);if(w(i),!i)return;const F=a.getBoundingClientRect().top;if((B(i)?window.innerHeight:i.getBoundingClientRect().bottom)>=F-e.threshold){const S={};m.current=S,yield l(!1),c(S)}}),{wait:100,leading:!0,trailing:!0});o.exports.useEffect(()=>{g()}),o.exports.useEffect(()=>{if(!u.current||!d)return;function i(){g()}return d.addEventListener("scroll",i),()=>{d.removeEventListener("scroll",i)}},[d]);function E(){return h(this,void 0,void 0,function*(){s(!1),yield l(!0),c(m.current)})}return P(e,t("div",{className:y,ref:u,children:typeof e.children=="function"?e.children(e.hasMore,n,E):e.children}))},D=r=>{const{locale:e}=R();return r.hasMore?r.failed?p("span",{children:[t("span",{className:`${y}-failed-text`,children:e.InfiniteScroll.failedToLoad}),t("a",{onClick:()=>{r.retry()},children:e.InfiniteScroll.retry})]}):p(v,{children:[t("span",{children:e.common.loading}),t(x,{})]}):t("span",{children:e.InfiniteScroll.noMore})};var _=z;const V=({loadMore:r,hasMore:e})=>t(_,{loadMore:r,hasMore:e,children:t(({hasMore:s})=>t(v,{children:s?p("div",{style:{marginBottom:"2.5rem"},children:[t("span",{style:{fontSize:"0.7rem"},children:"\u4E00\u5927\u6CE2\u4FE1\u606F\u5411\u4F60\u98DE\u5954\u8FC7\u6765~"}),t(x,{})]}):t("div",{style:{marginBottom:"2.5rem"},children:t("span",{style:{fontSize:"0.7rem"},children:"--- \u6211\u662F\u6709\u5E95\u7EBF\u7684 ---"})})}),{hasMore:e})});const W=({top:r})=>{const[e,n]=o.exports.useState(!1),s=M(()=>{(window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop||0)>r?n(!0):n(!1)},100);return o.exports.useEffect(()=>(document.addEventListener("scroll",s,!0),()=>document.removeEventListener("scroll",s)),[e]),t(v,{children:e&&t("div",{className:"to-top",onClick:()=>window.scrollTo(0,0),children:t("i",{className:"iconfont icon-fanhuijiantou"})})})};export{V as N,W as S};
